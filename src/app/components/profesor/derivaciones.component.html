<app-navbar></app-navbar>

<div
  class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 md:p-6 text-gray-800"
>
  <!--  Encabezado con datos académicos -->
  <div class="bg-white shadow-lg rounded-xl p-6 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">

      <div class="flex items-center space-x-2 ring-1 rounded-sm p-4 ring-blue-400">

        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
          <span class="text-blue-600 text-sm font-semibold">P</span>
        </div>
        <div >
          <p class="text-xs text-gray-500">Período</p>
          <p class="font-medium">{{ periodo }}</p>
        </div>

      </div>

      <div class="flex items-center space-x-2 ring-1 rounded-sm p-4 ring-green-400">
        <div
          class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"
        >
          <span class="text-green-600 text-sm font-semibold">C</span>
        </div>
        <div>
          <p class="text-xs text-gray-500">Curso</p>
          <p class="font-medium">{{ curso }}</p>
        </div>
      </div>

      <div class="flex items-center space-x-2 ring-1 rounded-sm p-4 ring-purple-400">
        <div
          class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center"
        >
          <span class="text-purple-600 text-sm font-semibold">F</span>
        </div>

        <div>
          <p class="text-xs text-gray-500">CFP</p>
          <p class="font-medium">{{ cfp }}</p>
        </div>
      </div>

      <div class="flex items-center space-x-2 ring-1 rounded-sm p-4 ring-orange-400">
        <div
          class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center"
        >
          <span class="text-orange-600 text-sm font-semibold">S</span>
        </div>
        <div>
          <p class="text-xs text-gray-500">Semestre</p>
          <p class="font-medium">{{ semestre }}</p>
        </div>
      </div>

      <div class="flex items-center space-x-2 ring-1 rounded-sm p-4 ring-red-400">
        <div
          class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center"
        >
          <span class="text-red-600 text-sm font-semibold">C</span>
        </div>
        <div>
          <p class="text-xs text-gray-500">Carrera</p>
          <p class="font-medium">{{ carrera }}</p>
        </div>
      </div>
    </div>

    <div class="mt-6 flex justify-end">
      <button
        (click)="searchEstudiante()"
        class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-all duration-200 focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 flex items-center space-x-2"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="11" cy="11" r="8" />
          <path d="m21 21-4.3-4.3" />
        </svg>
        <span>Buscar estudiante</span>
      </button>
    </div>
  </div>

  <!-- 🔹 Mostrar error si lo hay -->
  @if (error) {

  <div class="text-red-500 text-center mb-6">
    {{ error }}
  </div>
  }

  <!-- 🔹 Información del estudiante -->
  @if (estudiante) {
  <div class="bg-white shadow-lg rounded-lg p-6 mb-6">
    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 mr-2 text-indigo-600"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
        <circle cx="9" cy="7" r="4" />
        <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
      </svg>
      Información del Estudiante
    </h2>

    <div class="flex flex-col md:flex-row gap-8">
      <!-- Imagen del estudiante -->
      <div class="flex-shrink-0">
        <div class="relative">
          <img
            [src]="estudiante.foto || 'https://via.placeholder.com/150'"
            alt="Foto de {{ estudiante.nombre }}"
            class="w-40 h-40 object-cover rounded-xl shadow-md"
          />
          <div
            class="absolute -bottom-2 -right-2 bg-green-500 w-6 h-6 rounded-full border-4 border-white"
          ></div>
        </div>
      </div>
      <!-- Datos del estudiante -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-grow">
        <div class="space-y-1">
          <p class="text-sm text-gray-500">ID Estudiante</p>
          <p class="font-medium">{{ estudiante.id }}</p>
        </div>
        <div class="space-y-1">
          <p class="text-sm text-gray-500">Nombre Completo</p>
          <p class="font-medium">
            {{ estudiante.nombre }} {{ estudiante.apellido }}
          </p>
        </div>
        <div class="space-y-1">
          <p class="text-sm text-gray-500">Teléfono</p>
          <p class="font-medium">{{ estudiante.telefono }}</p>
        </div>
        <div class="space-y-1">
          <p class="text-sm text-gray-500">Correo</p>
          <p class="font-medium">{{ estudiante.correo }}</p>
        </div>
        <!--  -->
      </div>
    </div>
  </div>
  } @else {
  <p class="text-lg text-gray-600 text-center py-6">
    Selecciona un estudiante desde la sección "Estudiantes" para ver o agregar
    derivaciones.
  </p>
  }

  <!--  Formulario de derivación -->
  @if (estudiante) {
  <div class="bg-white shadow-lg rounded-xl p-6 mb-6">
    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 mr-2 text-indigo-600"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M12 5v14" />
        <path d="M5 12h14" />
      </svg>
      Agregar Derivación
    </h2>

    <div class="mb-6">
      <label class="block text-sm font-medium text-gray-700 mb-2"
        >Motivo de la derivación:</label
      >
      <textarea
        [(ngModel)]="motivo"
        class="w-full p-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200 resize-none"
        rows="4"
      ></textarea>
    </div>
    <button
      (click)="agregarDerivacion()"
      class="w-full md:w-auto bg-indigo-600 text-white px-8 py-3 rounded-xl hover:bg-indigo-700 transition-all duration-200 focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 flex items-center justify-center space-x-2"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M12 5v14" />
        <path d="M5 12h14" />
      </svg>
      <span>Agregar Derivación</span>
    </button>
  </div>
  }

  <!--  Lista de derivaciones previas -->
  @if (estudiante ) {
  <div class="bg-white shadow-lg rounded-xl p-6">
    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 mr-2 text-indigo-600"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
        <path d="M14 2v6h6" />
        <path d="M16 13H8" />
        <path d="M16 17H8" />
        <path d="M10 9H8" />
      </svg>
      Derivaciones Previas
    </h2>
    <div class="space-y-4">
      @for (derivacion of derivaciones; track $index) {
      <div class="p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-all duration-200">

        <div class="flex items-center justify-between mb-2" >
          <span class="text-sm font-medium text-indigo-600">{{derivacion.fecha}}</span>
          <span class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-xs font-medium">
            Registrado
          </span>

        </div>

        <p class="text-gray-700">{{ derivacion.motivo }}</p>
      </div>
      }
    </div>
  </div>
  }
</div>
